{% extends 'base.html.twig' %}

{% block title %}Content{% endblock %}

{% block body %}
<div class="container" id="down">
    <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
            <h1 class="post-title">Content index</h1>

    <table class="table table-bordered"  >
        <thead class="thead-dark">
        <tbody>
            <tr>
                 <th scope="col">Id</th>
                <td>{{ content.id }}</td>
            </tr>
            <tr>
                 <th scope="col">Title</th>
                <td>{{ content.title }}</td>
            </tr>
            <tr>
                 <th scope="col">Description</th>
                <td>{{ content.description }}</td>
            </tr>
            <tr>
                 <th scope="col">File</th>
                <td>{{ content.file }}</td>
            </tr>
            <tr>
                 <th scope="col">SubmitUser</th>
                <td>{{ content.userSubmit.firstname ? content.userSubmit.firstname : '' }}</td>
            </tr>
            <tr>
                 <th scope="col">SubmitDate</th>
                <td>{{ content.submitDate ? content.submitDate|date('Y-m-d H:i:s') : '' }}</td>
            </tr>
            <tr>
                 <th scope="col">ApprovalDate</th>
                <td>{{ content.approvalDate ? content.approvalDate|date('Y-m-d H:i:s') : '' }}</td>
            </tr>
            <tr>
                 <th scope="col">PublicationDate</th>
                <td>{{ content.publicationDate ? content.publicationDate|date('Y-m-d H:i:s') : '' }}</td>
            </tr>
        </tbody>
    </table>

            <button type="submit" class="btn btn-outline-primary">
                <a href="{{ path('content_index') }}"> <span class="btn-label"><i class="fas fa-arrow-left"></i></span>
                    back to list</a></button>
    <h5>Add a comment</h5>

    {{ include('comment/_form.html.twig') }}

    <h5>Comments</h5>
    <table>
        <tbody>

        {% if comments %}
            {% for comment in comments %}
                <tr>
                    <th>Message</th>
                    <td>{{ comment.message }}</td>
                    <td></td>
                    <td>
                        <a href="{{ path('comment_edit', {'id': comment.id}) }}" style="color: dodgerblue">edit comm</a>
                        <a href="{{ path('comment_delete', {'id': comment.id}) }}"  style="color: red">delete comm</a>
                    </td>
                </tr>
            {% endfor %}
        {% else %}
            <p>No comments</p>
        {% endif %}
        </tbody>
    </table>
    <br><br>

    <a href="{{ path('content_index') }}">back to list</a>

            <button type="submit" class="btn btn-outline-primary">
    <a href="{{ path('content_edit', {'id': content.id}) }}"><span class="btn-label"><i class="fas fa-edit"></i></span>
        edit</a></button>

          <br>

    <h3>Review</h3>
    <button class="btn btn-success review" value="1">Approved</button>
    <button class="btn btn-danger review" value="2">Rejected</button>

    {{ include('content/_delete_form.html.twig') }}

        </div>
    </div>
</div>
{% endblock %}

{% block javascripts %}
    <script language = "javascript"
            src = "https://code.jquery.com/jquery-2.2.4.min.js">
    </script>
    <script>
        $(function(){
            $(".review").click(function() {
                var contentStatus = $(this).val();
                $.ajax({
                    url: '{{ path('approval_new') }}',
                    type: 'POST',
                    data: {content_id: {{content.id}}, status: contentStatus },

                    success: function(data, status) {
                        alert(data)
                    },
                    error : function(xhr, textStatus, errorThrown) {
                        alert(errorThrown);
                    }
                });
            });
        });
    </script>
{% endblock %}
